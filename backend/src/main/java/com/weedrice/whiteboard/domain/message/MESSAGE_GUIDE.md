# Message 도메인 가이드

`message` 도메인은 이메일, PUSH, SMS 등 사용자에게 발송되는 각종 메시지를 비동기적으로 처리하기 위한 큐(Queue) 시스템을 담당합니다.

## 1. 주요 기능 및 로직

`MessageService`와 `MessageQueueScheduler`를 통해 다음과 같은 핵심 비즈니스 로직을 처리합니다.

- **메시지 큐 추가 (`queueEmail` 등):**
  - 이메일 발송이 필요한 시점(예: 회원가입 시 인증 메일)에 호출됩니다.
  - 발송할 대상, 방법, 내용 등의 정보를 `message_queue` 테이블에 `PENDING` 상태로 저장합니다.

- **메시지 발송 (`sendEmail`):**
  - `@Async` 어노테이션을 통해 비동기적으로 실행됩니다.
  - 실제 외부 메일 서버(예: JavaMailSender)와 연동하여 이메일을 발송하는 로직이 포함됩니다. (현재는 시뮬레이션 코드)
  - 발송 성공 시 `SENT`, 실패 시 `FAILED` 상태로 업데이트하고, 재시도 횟수를 증가시킵니다.

- **메시지 큐 처리 스케줄러 (`processMessageQueue`):**
  - `@Scheduled` 어노테이션을 통해 주기적으로(현재 1분마다) 실행됩니다.
  - `message_queue` 테이블에서 `PENDING` 상태이고, 재시도 횟수가 일정 횟수 미만인 작업들을 조회합니다.
  - 조회된 각 메시지에 대해 `sendEmail`과 같은 비동기 발송 메서드를 호출합니다.

## 2. API Endpoints

`message` 도메인은 사용자에게 직접 노출되는 API 엔드포인트가 없습니다. 다른 서비스 계층에서 `MessageService`를 호출하여 사용합니다.

## 3. 관련 DB 테이블

`message` 도메인은 주로 다음 테이블과 상호작용합니다.

| 테이블명          | 엔티티          | 설명             |
| :---------------- | :-------------- | :--------------- |
| `message_queue`   | `MessageQueue`  | 발송 대기 메시지 정보 |

이 문서는 `message` 도메인의 기능을 이해하고 개발하는 데 도움을 주기 위해 작성되었습니다.
